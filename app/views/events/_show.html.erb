<h1><%= @event.name %></h1>

<ul>
  <li><strong>Date:</strong> <%= @event.event_date %></li>
  <li><strong>Time:</strong>
    <%= @event.event_time.present? ? @event.event_time.strftime("%l:%M %p") : "Not set" %>
  </li>
  <li><strong>Location:</strong> <%= @event.location.presence || "Not set" %></li>
  <li><strong>Budget:</strong> <%= @event.budget.present? ? number_to_currency(@event.budget) : "Not set" %></li>
</ul>

<% if @event.extra_info.present? %>
  <p style="margin-top: 1rem;">
    <strong>Additional Event Info:</strong><br>
    <%= simple_format(@event.extra_info) %>
  </p>
<% end %>

<h2>Recipients for this event</h2>

<% if @event.recipients.any? %>
  <ul>
    <% @event.recipients.each do |recipient| %>
      <li>
        <%= recipient.name %>
        (<%= link_to "View", recipient_path(recipient) %>)
        |
        <%= link_to "Remove",
                    remove_recipient_event_path(@event, recipient.id),
                    data: { turbo_method: :delete, confirm: "Remove #{recipient.name} from this event?" } %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>You donâ€™t have any recipients assigned to this event yet.</p>
<% end %>

<h3>Add a recipient</h3>
<% if @available_recipients.any? %>
  <%= form_with url: add_recipient_event_path(@event), method: :post, local: true do |f| %>
    <%= f.label :recipient_id, "Choose an existing recipient" %>
    <%= f.collection_select :recipient_id,
                            @available_recipients,
                            :id, :name,
                            include_blank: "Select a recipient" %>
    <%= f.submit "Add to Event" %>
  <% end %>
<% else %>
  <p>All of your recipients are already assigned to this event.</p>
<% end %>
<h3>Collaborators</h3>
<ul>
  <% @event.collaborators.each do |u| %>
    <li><%= u.name || u.email %></li>
  <% end %>
</ul>
<h4>Add collaborator</h4>

<%= form_with url: add_collaborator_event_path(@event),
              method: :post,
              data: { turbo: false } do %>
  <%= label_tag :email, "User email" %>
  <%= text_field_tag :email, nil, required: true %>
  <%= submit_tag "Add" %>
<% end %>

<%= link_to "Create recipient to add to event",
            new_recipient_path(from_event: true, event_id: @event&.id) %>

<p>
  <%= link_to "Edit Event", edit_event_path(@event) %> |
  <%= link_to "Delete Event",
              event_path(@event),
              data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %> |
  <%= link_to "View All Events", events_path %> |
  <%= link_to "Back to Home", homepage_path %>
</p>
