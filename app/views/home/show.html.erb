<h1>Homepage</h1>

<p>Welcome, <%= current_user.name.presence || current_user.email %></p>
<%= link_to "View Profile", user_path(current_user) %> |
<%= link_to "Edit Profile", edit_user_path(current_user) %>
<h2>Your Gift Recipients</h2>

<%= link_to "View All Recipients", recipients_path %> |
<%= link_to "Add New Recipient", new_recipient_path %>

<% if current_user.recipients.any? %>
  <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
    <thead>
    <tr style="background-color: #f5f5f5;">
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Recipient Name</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Age</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Relation</th>
    </tr>
    </thead>
    <tbody>
    <% current_user.recipients.each do |recipient| %>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;">
          <%= link_to recipient.name, recipient_path(recipient) %>
        </td>
        <td style="border: 1px solid #ddd; padding: 8px;"><%= recipient.age %></td>
        <td style="border: 1px solid #ddd; padding: 8px;"><%= recipient.relation %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% else %>
  <p style="margin-top: 1rem;">No recipients added yet.</p>
<% end %>

<h2 style="margin-top: 2rem;">Your Events</h2>

<p>
  <%= link_to "View All Events", events_path %> |
  <%= link_to "Add New Event", new_event_path %>
</p>

<% if @events.any? %>
  <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
    <thead>
    <tr style="background-color: #f5f5f5;">
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Event Name</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Date</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Time</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Location</th>
      <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Actions</th>
    </tr>
    </thead>
    <tbody>
    <% @events.each do |event| %>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;">
          <%= link_to event.name, event_path(event) %>
        </td>
        <td style="border: 1px solid #ddd; padding: 8px;"><%= event.event_date %></td>
        <td style="border: 1px solid #ddd; padding: 8px;">
          <%= event.event_time.present? ? event.event_time.strftime("%l:%M %p") : "" %>
        </td>
        <td style="border: 1px solid #ddd; padding: 8px;"><%= event.location %></td>
        <td style="border: 1px solid #ddd; padding: 8px;">
          <%= link_to "Edit Event", edit_event_path(event) %> |
          <%= link_to "Delete Event",
                      event_path(event),
                      data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% else %>
  <p>You donâ€™t have any events yet.</p>
<% end %>

<h2 style="margin-top: 2rem;">Your Budgets</h2>

<p>
  <%= link_to "View All Budgets", event_recipient_budgets_path %> |
  <%= link_to "Add New Budget", new_event_recipient_budget_path %>
</p>

<%= link_to "Log out",
            logout_path,
            data: { turbo_method: :delete },
            "data-test": "logout" %>
